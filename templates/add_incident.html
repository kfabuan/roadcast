{% extends 'nav_admin.html' %}

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?libraries=places&key=AIzaSyACS7G3CoYRTEAOy4vAUdPq1H08ueUoDXI"></script>

{% block title %} Add Incident {% endblock %}

{% block design %}
    <style>
        body {
            background-color: #f8fcfd;
            position: relative;
            padding-right: 0;
            /* padding-left: 0; */
            /* margin-right: 2%; */
        }
        .label-blue {
            text-transform: uppercase; 
            font-size:small; 
            letter-spacing: 0.5px; 
            font-weight: bold; 
            color: #1b5082;
        }

        .card {
            box-shadow: 0 0.5rem 1rem 0 rgba(0,0,0,0.1);
            border-radius: 15px;
        }

        .card-header {
            --bs--bg-opacity:1
            background-color: #fff;
            border-radius: 13px 13px 0 0 !important;
            margin:0;
        }

        .gmap_iframe, .mapouter {
            border-radius: 15px !important;
            margin-bottom: -3px;
            margin-right: -1px;
        }
        .mapouter{
            overflow:hidden;
            background:none!important;
        }

        .form-control, .form-select {
            border-radius: 15px !important;
        }

        .chk_offense {
            
            font-size:small; 
            border-color: #ced4da !important; 
            border-radius: 10px !important;
            color: gray;
        }

        .container {
            position: absolute !important;
            width: auto;
            top:35%;
            /* background-color: tomato;  */
            padding-left: 4%;
        }

        .cover-bg {
            height: 350px !important;
            background-size: 100% auto;
            background-position: top !important;
            object-fit: cover;
            border-radius:50px 50px 0px 0px;
        }

        .page-title {
            text-transform: uppercase; 
            font-size:32px; 
            /* letter-spacing: 0.5px; */
            font-weight:500;  
            color: white;
            text-shadow:1px 1px 3px #c6c6c6;
        }

        .page-subheading {
            /* text-transform: uppercase;  */
            font-size:medium; 
            letter-spacing: 0.5px; 
            font-weight: normal; 
            color: white;
            margin-left: 2px;
            text-shadow:1px 1px 3px #c6c6c6;"
        }

        .bg-custom {
            --bs-bg-opacity: 1;
            background-color: #0F4C81!important;
        }
        .bg-custom2 {
            --bs-bg-opacity: 1;
            background-color: #033FFF!important;
        }
        .bg-custom3 {
            --bs-bg-opacity: 1;
            background-color: #787A91!important;
        }
        .bg-custom4 {
            --bs-bg-opacity: 1;
            background-color: #FFA41B!important;
        }

        .inv-txt {
            border-style: none;
            background-color: transparent; 
            color: white;
            font-weight: bold;
            padding: 0;
            margin: 0;
        }

        .badge {
            padding-top: 1px;
            padding-bottom: 1px;
        }
        option {
           color: black !important;
        }

        .csv-btn { float: right; margin-right: 10px;}
        .csv-btn:hover{
            background-color: #033FFF;
            color:white !important;
            font-weight: normal;
        }

        .asterisk {
            color: red;
            font-weight: bold;
        }

        @media only screen and (max-width: 3101px) and (min-width: 2600px){
            .container {margin-left: 590px; }
            .col-sm-4 { width: 100%;}
            .col-sm-8 { width: 100%;}
        }

        @media only screen and (max-width: 2599px) and (min-width: 2300px){
            .container {margin-left: 490px; }
            .col-sm-4 { width: 100%;}
            .col-sm-8 { width: 100%;}
        }

        @media only screen and (max-width: 2299px) and (min-width: 2101px){
            .container {margin-left: 360px; }
        }

        @media only screen and (max-width: 2100px) and (min-width: 2001px){
            .container {margin-left: 260px; }
        }

        @media only screen and (max-width: 2000px){
            .container {margin-left: 200px; }
        }

        @media only screen and (max-width: 1800px){
            .container {margin-left: 130px; }
        }

        @media only screen and (max-width: 1700px){
            .container {margin-left: 50px; }
        }

        @media only screen and (max-width: 1600px){
            .container {margin-left: 30px; }
        }

        @media only screen and (max-width: 1500px){
            .container {margin-left: 10px; }
        }

        @media only screen and (max-width: 1400px){
            .container {margin-left: 50px; }
        }


        @media only screen and (max-width: 1300px){
            .container {margin-left: 20px; }
        }

        @media only screen and (max-width: 1200px){
            .container {margin-left: 40px; }
        }

        @media only screen and (max-width: 1100px){
            .container {margin-left: 10px; }
            .col-sm-4 { width: 100%;}
            .col-sm-8 { width: 100%;}
        }

    
        @media only screen and (max-width: 1000px){
            .container {margin-left: 50px; }
        }

        @media only screen and (max-width: 900px){
            .container {margin-left: 20px; }
        }

        @media only screen and (max-width: 800px){
            .container {margin-left: 5px; }
        }

        @media only screen and (max-width: 768px){
            .container {margin-left: 95px; }
        }

        @media only screen and (max-width: 700px){
            .container {margin-left: 70px; }
        }

        @media only screen and (max-width: 670px){
            .container {margin-left: 50px; }
        }

        @media only screen and (max-width: 630px){
            .container {margin-left: 30px; }
        }

        @media only screen and (max-width: 580px){
            .container {margin-left: 20px; }
            .page-title {font-size: 28px;}
            .csv-btn {font-size: 14px;}
        }

        @media only screen and (max-width: 500px){
            .container {margin-left: 20px; }
            .page-title {font-size: 22px;}
        }

        @media only screen and (max-width: 400px){
            .container {margin-left: 15px; }
            .page-title {font-size: 18px;}
        }

        @media only screen and (max-width: 370px){
            .container {margin-left: 12px; }
        }

    </style>
{% endblock %}

{% block content %}

<!-- Login required and permission access of users (Should be placed after the opening block content) -->
{% if request.session.authorized_id %}
    {% for a in all %}
        {% ifequal a.id request.session.authorized_id %}
            {% if a.Members_User.Member_Type == 'Crime Statistician' %} 
                <!-- body (no need to paste anything here) -->

            {% else %}
                <script>
                    window.location.href = '{% url 'error_page' %}';  
                </script>
            {% endif %}

        {% endifequal %}
    {% endfor %}

{% elif request.session.public_id %}
    {% if request.session.public_id %}
        {% for b in pub %}
            {% ifequal b.id request.session.public_id %} 
                <script>
        		    window.location.href = '{% url 'error_page' %}';  
    		    </script>
            {% endifequal %}
        {% endfor %}

    {% else %}
        <script>
            window.location.href = '{% url 'login_required' %}';
        </script>
    {% endif %}
    
{% else %}
    <script>
        window.location.href = '{% url 'login_required' %}';  
    </script>
{% endif %}

<div class="row header-img">
    <img src="/static/image/city.gif" class=" cover-bg" alt="Background Cover">
</div>



<div class="container">
 <script>
function initMap() {
    var map = new google.maps.Map(document.getElementById('map'), {
      center: {lat: 14.580466330345176 , lng: 121.09153585874454},
      zoom: 15
    });
    var input = document.getElementById('place_committed');
    // map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

    var autocomplete = new google.maps.places.Autocomplete(input);
    autocomplete.bindTo('bounds', map);

    var infowindow = new google.maps.InfoWindow();
    var marker = new google.maps.Marker({
        map: map,
        anchorPoint: new google.maps.Point(0, -29)
    });

    autocomplete.addListener('place_changed', function() {
        infowindow.close();
        marker.setVisible(false);
        
        var place = autocomplete.getPlace();
        if (!place.geometry) {
            window.alert("Autocomplete's returned place contains no geometry");
            return;
        }
  
        // If the place has a geometry, then present it on a map.
        if (place.geometry.viewport) {
            map.fitBounds(place.geometry.viewport);
        } else {
            map.setCenter(place.geometry.location);
            map.setZoom(17);
        }
        marker.setIcon(({
            url: place.icon,
            size: new google.maps.Size(71, 71),
            origin: new google.maps.Point(0, 0),
            anchor: new google.maps.Point(17, 34),
            scaledSize: new google.maps.Size(35, 35)
        }));
        marker.setPosition(place.geometry.location);
        marker.setVisible(true);
    
        var address = '';
        if (place.address_components) {
            address = [
              (place.address_components[0] && place.address_components[0].short_name || ''),
              (place.address_components[1] && place.address_components[1].short_name || ''),
              (place.address_components[2] && place.address_components[2].short_name || '')
            ].join(' ');
        }
    
        infowindow.setContent('<div><strong>' + place.name + '</strong><br>' + address);
        infowindow.open(map, marker);
      
        // Location details
       
        // document.getElementById('place_committed').value = place.formatted_address;
        document.getElementById('lat').value = place.geometry.location.lat();
        document.getElementById('lon').value = place.geometry.location.lng();
    });
}
</script>
   
    <!-- Upper Section (Maayos spacing hehe) -->
    <section style="height: 25px;"></section>
    <!-- {% if success_message %}<p class="alert alert-success"><strong>{{ success_message|safe }}</strong> </p>{% endif %}
    {% if error_message %}<p class="alert alert-danger"><strong>{{ error_message|safe }}</strong> </p>{% endif %}
    {% if messages %}{% for message in messages %}<p class="alert alert-danger"> <strong>{{ message|safe }}</strong></p>{% endfor %}{% endif%}

    -->
   <div class="row">
       <div class="col-8">
            <p class="page-title" style="text-shadow:1px 1px 3px #c6c6c6;">CREATE AN INCIDENT REPORT <i class="bi bi-plus-circle"></i>  </p>
       </div>
       <div class="col-4 csv-col">
           <a href="{% url 'upload_csv' %}" class="btn btn-light text-primary fw-bold csv-btn">+ Import CSV</a>
       </div>
   
   </div>
    <form method="POST" enctype="multipart/form-data" action="{% url 'process_add_incident' %}">
        {% csrf_token %}

    <p class="page-subheading">
        <i>Assigned Investigator: <span class="asterisk">*</span></i>
        <span class="badge bg-custom2 text-light rounded-pill">            
            <select name="inv_name" id="inv_name" class="inv-txt" required>
                <option value=""></option>
                {% for inv in investigators_list %}
                    <option value="{{ inv.id }}"> {{ inv.Members_Fname}} {{ inv.Members_Lname}}</option>
                {% endfor %}
            </select>  
        </span> 
    </p>

    <section style="height: 15px;"></section>
    
    <div class="row form-con" style="" class="">
    <!-- Main Content -->

        <div class="row">
            <div class="col-sm-4">

                <div class="">    
                    <div class="card mb-3 mt-3">
                        <div class="card-header">
                            <label class="label-blue"><i class="bi bi-info-circle-fill"></i> Incident Details</label>
                            <i class="bi bi-question-circle" style="color: #d3d3d3; float: right;"></i>
                        </div>
                        <div class="card-body">
    
                            <div class="row g-2 mb-3">
                                <div class="col-6">
                                    <div class="form-floating">
                                        <select name="weather" id="weather" class="form-select form-select-sm">
                                            <option value=""></option>
                                            <option value="Sun">Sun</option>
                                            <option value="Fair">Fair</option>
                                            <option value="Light Rain">Light Rain</option>
                                            <option value="Rainy">Rainy</option>
                                            <option value="Wind">Wind</option>
                                        </select>  
                                        <label for="" style="font-size: small;" class="text-muted">Weather</label>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="form-floating">
                                        <select name="collision_type" id="collision_type" class="form-select form-select-sm" required>
                                            <option value=""></option>
                                            <option value="Angle Collision">Angle Collision</option>
                                            <option value="Bumped From Behind">Bumped From Behind</option>
                                            <option value="Clash">Clash</option>
                                            <option value="Head On">Head On</option>
                                            <option value="Hit and Run">Hit and Run</option>
                                            <option value="Hit Animals">Hit Animals</option>
                                            <option value="Hit Object On Road">Hit Object On Road</option>
                                            <option value="Hit Object Off Road">Hit Object Off Road</option>
                                            <option value="Hit Parked Vehicle">Hit Parked Vehicle</option>
                                            <option value="Hit Pedestrian">Hit Pedestrian</option>
                                            <option value="Hit While Parked">Hit While Parked</option>
                                            <option value="Multi Vehicle">Multi Vehicle</option>
                                            <option value="Rear End">Rear End</option>
                                            <option value="Self Accident">Self Accident</option>
                                            <option value="Impact">Impact</option>
                                            <option value="Sideswiped">Sideswiped</option>
                                            <option value="Side Impact">Side Impact</option>
                                            <option value="Right Angle">Right Angle</option>
                                            <option value="Others">Others</option>
                                        </select>
                                        <label for="" style="font-size: small;" class="text-muted">Collision Type <span class="asterisk">*</span></label>
                                    </div>
                                </div>
                            </div>
    
                            <div class="row g-2 mb-3">
                                <div class="col-6">
                                    <div class="form-floating">
                                        <select name="surface_type" id="surface_type" class="form-select form-select-sm">
                                            <option value=""></option>
                                            <option value="Asphalt">Asphalt</option>
                                            <option value="Concrete">Concrete</option>
                                            <option value="Soil">Soil</option>
                                        </select>
                                        <label for="" style="font-size: small;" class="text-muted">Surface Type</label>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="form-floating">
                                        <select name="surface_condition" class="form-select form-select-sm">
                                            <option value=""></option>
                                            <option value="Dry">Dry</option>
                                            <option value="Wet">Wet</option>
                                            <option value="Sand">Sand</option>
                                        </select>
                                        <label for="" style="font-size: small;" class="text-muted">Surface Condition</label>
                                    </div>
                                </div>
                            </div>
    
                            <div class="row g-2 mb-3">
                                <div class="col-6">
                                    <div class="form-floating">
                                        <select name="road_character" id="road_character" class="form-select form-select-sm">
                                            <option value=""></option>
                                            <option value="Straight Flat">Straight/Flat</option>
                                            <option value="Straight Incline">Straight/Incline</option>
                                            <option value="Curve">Curve</option>
                                            <option value="Curve Incline">Curve/Incline</option>
                                            <option value="Upwards">Upwards</option>
                                            <option value="Downwards">Downwards</option>
                                        </select>
                                        <label for="" style="font-size: small;" class="text-muted">Road Character</label>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="form-floating">
                                        <select name ="case_status" class="form-select form-select-sm" required>
                                            <option value=""></option>
                                            <option value="Solved">Solved</option>
                                            <option value="Unsolved">Unsolved</option>
                                        </select>
                                        <label for="" style="font-size: small;" class="text-muted">Case Status <span class="asterisk">*</span></label>
                                    </div>
                                </div>
                            </div>
    
                            <div class="row g-2 mb-3">
                                <div class="col-6">
                                    <div class="form-floating">
                                        <select class="form-select form-select-sm" id="hit-and-run" name="hit-and-run">
                                            <option value=""></option>
                                            <option value="Yes">Yes</option>
                                            <option value="No">No</option>
                                        </select>
                                        <label for="" style="font-size: small;" class="text-muted">Hit and Run</label>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="form-floating">
                                        <select class="form-select form-select-sm" id="road-repair" name="road-repair">
                                            <option value=""></option>
                                            <option value="Yes">Yes</option>
                                            <option value="No">No</option>
                                        </select>
                                        <label for="" style="font-size: small;" class="text-muted">Road Repair</label>
                                    </div>
                                </div>
                            </div>
    
    
                                <div class="col-12" style="background-color: none; display: grid !important;">
                                    <div class="btn-group" role="">
                                        <input type="checkbox" class="btn-check chk_offense_input" id="btncheck2" value="Physical Injury" autocomplete="off">
                                        <label class="btn btn-outline-primary chk_offense" for="btncheck2">Physical Injury</label>
                                        
                                        <input type="checkbox" class="btn-check chk_offense_input" id="btncheck3" value="Self Accident" autocomplete="off">
                                        <label class="btn btn-outline-primary chk_offense" for="btncheck3">Self Accident</label>
                                    </div>
        
                                </div> 

                                <div class="col-12 " style="background-color: none; display: grid !important;">
                                    <div class="btn-group" role="" class="group-offense">
                                        <input type="checkbox" class="btn-check chk_offense_input" id="btncheck4" value="Homicide" autocomplete="off">
                                        <label class="btn btn-outline-primary chk_offense" for="btncheck4">Homicide</label>
        
                                        <input type="checkbox" class="btn-check chk_offense_input" id="btncheck1" value="Damage to Property" autocomplete="off">
                                        <label class="btn btn-outline-primary chk_offense" for="btncheck1">Damage to Property</label>
                                    </div> 
                                    <input type="text" id="display_offense" name ="display_offense" class="form-field"hidden required >
                                </div>

                                <script type="text/javascript">
                                    $(document).ready(function(){
                                         $('#btn-create').click(function(){
                                            if (document.getElementById('display_offense').value == "" ) {
                                            alert('Please select an offense before submitting and fill out all the required fields.')  
                                            }
                                        });
                                    });
                                </script>
                                
                        
                        </div>
                    </div> <!-- incident's detail card closing-->

                    <div class="card">
                        <div class="card-header">
                            <label class="label-blue"><i class="bi bi-geo-alt-fill"></i> Location Details</label>
                            <i class="bi bi-question-circle" style="color: #d3d3d3; float: right;"></i>
                        </div>

                        <div class="card-body">
                            <div class="row g-2 mb-3">
                                <div class="col-6">
                                    <input type="text" name="city" value="" placeholder ="Pasig City"class="form-control form-control-sm" readonly>
                                </div>
                                <div class="col-6">
                                    <input type="text" id="district" name="district" value="" placeholder="District"class="form-control form-control-sm" readonly>
                                </div>
                            </div>
                        
                            <div class="form-floating mb-3">
                                <select name="barangay" id="barangay" class="form-select form-select-sm" onchange="selectdistrict(event)" required>
                                    <option value=""></option>
                                    {% for brgy in brgy_list %}
                                        <option value="{{brgy.id}}">{{brgy.Barangay}} </option>
                                    {% endfor %}
                                </select>                            
                                <label for="" style="font-size: small;" class="text-muted">Barangay <span class="asterisk">*</span></label>
                            </div>

                            <script>
                                function selectdistrict(e){
                        
                                    if (e.target.value == "19"||e.target.value == "20"||e.target.value == "21"||e.target.value == "22"||e.target.value == "23"
                                    ||e.target.value == "24"||e.target.value == "26"||e.target.value == "25"){
                                    var barangay = document.getElementById('district').value="2";
                                    }
                                    else{
                                    var barangay = document.getElementById('district').value="1";
                                    }
                                }
                            </script>

                          

                            <div class="form-floating mb-3">
                                <input type="text" name="place_committed" id="place_committed" class="form-control form-control-sm" required>
                                <label for="" style="font-size: small;" class="text-muted">Place Committed <span class="asterisk">*</span></label>
                            </div>

                            <div class="row g-2 mb-3">
                                <div class="col-6">
                                    <input type="text" name="along" value="" placeholder="Along" class="form-control form-control-sm">
                                </div>
                                <div class="col-6">
                                    <input type="text" id="corner" name="corner" value="" placeholder="Corner" class="form-control form-control-sm">
                                </div>
                            </div>

                            <div class="row g-2">
                                <div class="col-6">
                                    <div class="form-floating">
                                        <input type="date" id="DateCommitted" name="DateCommitted" class="form-control-sm form-control" required>                                        
                                        <label for="" style="font-size: small;" class="text-muted">Date Committed <span class="asterisk">*</span></label>
                                        <input type="text" name="day_of_the_week" id="day_of_the_week" class="form-field" hidden>
                                        <input type="text" name="week" id="week" class="form-field"  hidden>
                                    </div>
                                </div>
                            
                                <div class="col-6">
                                    <div class="form-floating">
                                        <input type="time" id="currentTime" name="currentTime" class="form-control-sm form-control text-nowrap overflow-hidden" required>                                        
                                        <label for="" style="font-size: small;" class="text-muted">Time Committed <span class="asterisk">*</span></label>
                                    </div>
                                </div>
                            </div>
                            <div class="row g-2 mb-3">
                                <div class="col-6">
                                    <input type="text" id="lat" name="lat" placeholder="Latitude" class="form-control form-control-sm" hidden>
                                </div>
                                <div class="col-6">
                                    <input type="text" id="lon" name="long" placeholder="Longitude" class="form-control form-control-sm" hidden>
                                </div>
                            </div>
                        </div> <!--card body-->
                    </div> <!--card  of loc details-->

                </div>
            </div> <!--left side cards-->

                <!--middle side cards -->
                <div class="col-sm-4 mt-3">
                    <div class="card">
                        <div class="card-header">
                            <label class="label-blue"><i class="bi bi-person-fill"></i> Suspect's Details</label>
                            <i class="bi bi-question-circle" style="color: #d3d3d3; float: right;"></i>
                        </div>
                        <div class="card-body">
                            
                            <div class="form-floating mb-3">
                                <input type="text" name="sus_fname" id="sus_fname" class="form-control form-control-sm" placeholder="First Name" required>
                                <label for="" style="font-size: small;" class="text-muted">First Name <span class="asterisk">*</span></label>
                            </div>
                        
                        
                            <div class="form-floating mb-3">
                                <input type="text" name="sus_lname" id="sus_lname" class="form-control form-control-sm" placeholder="Last Name" required>
                                <label for="" style="font-size: small;" class="text-muted">Last Name <span class="asterisk">*</span></label>
                            </div>

                            <div class="row g-2 mb-3">
                                <div class="col-6">
                                    <div class="form-floating">
                                        <select class="form-select form-select-sm" id="s_sex" name="s_sex" required>
                                            <option value=""></option>
                                            <option value="Male">Male</option>
                                            <option value="Female">Female</option>
                                        </select>
                                        <label for="" style="font-size: small;" class="text-muted">Sex <span class="asterisk">*</span></label>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="form-floating">
                                        <input type="number" name="sus_age" class="form-control form-control-sm" placeholder="Age" required>
                                        <label for="" style="font-size: small;" class="text-muted">Age <span class="asterisk">*</span></label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-floating mb-3">
                                <input type="text" name="sus_add" class="form-control form-control-sm" placeholder="Address" required>
                                <label for="" style="font-size:small;" class="text-muted">Address <span class="asterisk">*</span></label>
                            </div>

                            <div class="row g-2 mb-3">
                                <div class="col-md">
                                    <div class="form-floating">
                                        <select name="sus_civil_status" id="sus_civil_status" class="form-select form-select-sm" placeholder="Civil Status">
                                            <option value=""></option>
                                            <option value="Single">Single</option>
                                            <option value="Married">Married</option>
                                            <option value="Widowed">Widowed</option>
                                            <option value="Separated">Separated</option>
                                            <option value="Divorced">Divorced</option>
                                        </select>
                                        <label for="" style="font-size: small;" class="text-muted">Civil Status</label>
                                    </div>
                                </div>
                                <div class="col-md">
                                    <div class="form-floating">
                                        <select class="form-select form-select-sm" id="sus_type" name="sus_type" required>
                                            <option value=""></option>
                                            <option value="Driver">Driver</option>
                                            <option value="Passenger">Passenger</option>
                                            <option value="Pedestrian">Pedestrian</option>
                                        </select>
                                        <label for="" style="font-size: small;" class="text-muted">Suspect Type <span class="asterisk">*</span></label>
                                    </div>
                                </div>
                            </div>

                            <div class="form-floating mb-3">
                                <input type="text" name="sus_drl" class="form-control form-control-sm">
                                <label for="" style="font-size: small;" class="text-muted">Driver's License</label>
                            </div>

                            <div class="row g-2 mb-3">
                                <div class="col-md">
                                    <div class="form-floating">
                                        <input type="text" name="sus_vehicle" class="form-control" required>
                                        <label for="" style="font-size: small;" class="text-muted">Vehicle Brand/Model <span class="asterisk">*</span></label>
                                    </div>
                                </div>
                                <div class="col-md">
                                    <div class="form-floating">
                                        <select class="form-select-sm form-select" id="sus_vehicle_body_type" name="sus_vehicle_body_type" required>
                                            <option value=""></option>
                                                <option value="Armored Car">Armored Car</option>
                                                <option value="Alto">Alto</option>
                                                <option value="Bicycle">Bicycle</option>
                                                <option value="Private Bus">Private Bus</option>
                                                <option value="PUB - Public Utility Bus">PUB - Public Utility Bus</option>
                                                <option value="Cab Chassis ">Cab Chassis </option>
                                                <option value="Coupe">Coupe</option>
                                                <option value="Electric Bike">Electric Bike</option>
                                                <option value="Jitney">Jitney</option>
                                                <option value="Hatchback">Hatchback</option>
                                                <option value="Motorcycle">Motorcycle</option>
                                                <option value="MTC/MC">MTC/MC</option>
                                                <option value="Pedicab">Pedicab</option>
                                                <option value="PUJ/PUB/PUV - (Public Utility Bus/Public Utility Jeep/Public Utility Vehicle)">PUJ/PUB/PUV - (Public Utility Bus/Public Utility Jeep/Public Utility Vehicle)</option>
                                                <option value="PUJ - Public Utility Jeep">PUJ - Public Utility Jeep</option>
                                                <option value="PUV- Public Utility Vehicle">PUV- Public Utility Vehicle</option>
                                                <option value="Sedan">Sedan</option>
                                                <option value="S-CUV">S-CUV</option>
                                                <option value="Shuttle">Shuttle</option>
                                                <option value="SUV">SUV</option>
                                                <option value="Tricycle">Tricycle</option>
                                                <option value="Train">Train</option>
                                                <option value="Truck">Truck</option>
                                                <option value="Trailer">Trailer</option>
                                                <option value="Unidentified">Unidentified</option>
                                                <option value="Pick-Up">Pick-Up</option>
                                                <option value="Minivan">Minivan</option>
                                                <option value="Van">Van</option>
                                                <option value="Wagon">Wagon</option>
                                                <option value="Cart">Cart</option>
                                                <option value="Unidentified">Unidentified</option>
                                                <option value="Modern Jeepney">Modern Jeepney</option>
                                                <option value="Others">Others</option>
                                            </select>
                                        <label for="" style="font-size: small;" class="text-muted">Vehicle Body Type <span class="asterisk">*</span></label>
                                    </div>
                                </div>
                            </div>

                            <div class="form-floating">
                                <input type="text" name="sus_reg_owner" id="sus_reg_owner" class="form-control form-control-sm">
                                <label for="" style="font-size: small;" class="text-muted">Registered Owner </label>
                            </div>

                            <div class="form-check mb-3 ms-1 mt-1">
                                <input class="form-check-input" type="checkbox" value="" id="same_as_sus_name">
                                <label class="form-check-label text-muted" for="same_as_sus_name" for="" style="font-size: small;">
                                  Same as suspect's name
                                </label>
                            </div>

                            <div class="row g-2 mb-3">
                                <div class="col-md">
                                    <div class="form-floating">
                                        <input type="date" name="sus_drl_exp" class="form-control form-control-sm">
                                        <label for="" style="font-size: small;" class="text-muted">Expiration Date </label>
                                    </div>
                                </div>
                                <div class="col-md">
                                    <div class="form-floating">
                                        <input type="text" id="sus_plate_no" name="sus_plate_no" class="form-control form-control-smd" required>
                                        <label for="" style="font-size: small;" class="text-muted">Plate Number <span class="asterisk">*</span></label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-floating mb-3">
                                <select name="sus_severity" class="form-select form-select-sm" required>
                                    <option value=""></option>
                                    <option value="Unharmed">Unharmed</option>
                                    <option value="Harmed">Harmed</option>
                                    <option value="Injured">Injured</option>
                                    <option value="Self Accident">Self Accident</option>
                                    <option value="Deceased">Deceased</option>
                                    <option value="Identified">Identified</option>
                                    <option value="Not Interested to Report">Not Interested to Report</option>
                                    <option value="Arrested">Arrested</option>
                                    <option value="Escaped">Escaped</option>
                                    <option value="Unidentified">Unidentified</option>
                                    </select>
                                <label for="" style="font-size: small;" class="text-muted">Severity Status <span class="asterisk">*</span></label>
                            </div>
                        
                            <div class="form-floating mb-3">
                                <label for="" style="font-size: small;" class="text-muted"></label>
                            </div>
                        </div>
                    </div>
                </div> <!--middle cards -->

                <!--right side cards -->
                <div class="col-sm-4 mt-3">
                    <div class="card">
                        <div class="card-header">
                            <label class="label-blue"><i class="bi bi-person-fill"></i> Victim's Details</label>
                            <i class="bi bi-question-circle" style="color: #d3d3d3; float: right;"></i>
                        </div>
                        <div class="card-body">
                          
                            <div class="form-floating mb-3">
                                <input type="text" name="vic_fname" id="vic_fname" class="form-control form-control-sm" placeholder="First Name" required>
                                <label for="" style="font-size: small;" class="text-muted">First Name <span class="asterisk">*</span></label>
                            </div>
                        
                            <div class="form-floating mb-3">
                                <input type="text" name="vic_lname" id="vic_lname" class="form-control form-control-sm" placeholder="Last Name" required>
                                <label for="" style="font-size: small;" class="text-muted">Last Name <span class="asterisk">*</span></label>
                            </div>
            
                            <div class="row g-2 mb-3">
                                <div class="col-6">
                                    <div class="form-floating">
                                        <select class="form-select form-select-sm" id="v_sex" name="v_sex" required>
                                            <option value=""></option>
                                            <option value="Male">Male</option>
                                            <option value="Female">Female</option>
                                        </select>
                                        <label for="" style="font-size: small;" class="text-muted">Sex <span class="asterisk">*</span></label>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="form-floating">
                                        <input type="number" name="vic_age" id="vic_age" class="form-control form-control-sm" placeholder="Age" required>
                                        <label for="" style="font-size: small;" class="text-muted">Age <span class="asterisk">*</span></label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-floating mb-3">
                                <input type="text" name="vic_add" id="vic_add" class="form-control form-control-sm" placeholder="Address" required>
                                <label for="" style="font-size:small;" class="text-muted">Address <span class="asterisk">*</span></label>
                            </div>

                            <div class="row g-2 mb-3">
                                <div class="col-md">
                                    <div class="form-floating">
                                        <select name="vic_civil_status" id="vic_civil_status" class="form-select form-select-sm" placeholder="Civil Status" required>
                                            <option value=""></option>
                                            <option value="Single">Single</option>
                                            <option value="Married">Married</option>
                                            <option value="Widowed">Widowed</option>
                                            <option value="Separated">Separated</option>
                                            <option value="Divorced">Divorced</option>
                                        </select>
                                        <label for="" style="font-size: small;" class="text-muted">Civil Status <span class="asterisk">*</span></label>
                                    </div>
                                </div>
                                <div class="col-md">
                                    <div class="form-floating">
                                        <select class="form-select form-select-sm" id="vic_type" name="vic_type" required>
                                            <option value=""></option>
                                            <option value="Driver">Driver</option>
                                            <option value="Passenger">Passenger</option>
                                            <option value="Pedestrian">Pedestrian</option>
                                        </select>
                                        <label for="" style="font-size: small;" class="text-muted">Victim Type <span class="asterisk">*</span></label>
                                    </div>
                                </div>
                            </div>

                            <div class="form-floating mb-3">
                                <input type="text" name="vic_drl" id="vic_drl" class="form-control form-control-sm">
                                <label for="" style="font-size: small;" class="text-muted">Driver's License</label>
                            </div>

                            <div class="row g-2 mb-3">
                                <div class="col-md">
                                    <div class="form-floating">
                                        <input type="text" name="vic_vehicle" id="vic_vehicle" class="form-control" required>
                                        <label for="" style="font-size: small;" class="text-muted">Vehicle Brand/Model <span class="asterisk">*</span></label>
                                    </div>
                                </div>
                                <div class="col-md">
                                    <div class="form-floating">
                                        <select class="form-select-sm form-select" name="vic_vehicle_body_type" id="vic_vehicle_body_type" required>
                                            <option value=""></option>
                                                <option value="Armored Car">Armored Car</option>
                                                <option value="Alto">Alto</option>
                                                <option value="Bicycle">Bicycle</option>
                                                <option value="Private Bus">Private Bus</option>
                                                <option value="PUB - Public Utility Bus">PUB - Public Utility Bus</option>
                                                <option value="Cab Chassis">Cab Chassis </option>
                                                <option value="Coupe">Coupe</option>
                                                <option value="Electric Bike">Electric Bike</option>
                                                <option value="Jitney">Jitney</option>
                                                <option value="Hatchback">Hatchback</option>
                                                <option value="Motorcycle">Motorcycle</option>
                                                <option value="MTC/MC">MTC/MC</option>
                                                <option value="Pedicab">Pedicab</option>
                                                <option value="PUJ/PUB/PUV - (Public Utility Bus/Public Utility Jeep/Public Utility Vehicle)">PUJ/PUB/PUV - (Public Utility Bus/Public Utility Jeep/Public Utility Vehicle)</option>
                                                <option value="PUJ - Public Utility Jeep">PUJ - Public Utility Jeep</option>
                                                <option value="PUV- Public Utility Vehicle">PUV- Public Utility Vehicle</option>
                                                <option value="Sedan">Sedan</option>
                                                <option value="S-CUV">S-CUV</option>
                                                <option value="Shuttle">Shuttle</option>
                                                <option value="SUV">SUV</option>
                                                <option value="Tricycle">Tricycle</option>
                                                <option value="Train">Train</option>
                                                <option value="Truck">Truck</option>
                                                <option value="Trailer">Trailer</option>
                                                <option value="Unidentified">Unidentified</option>
                                                <option value="Pick-Up">Pick-Up</option>
                                                <option value="Minivan">Minivan</option>
                                                <option value="Van">Van</option>
                                                <option value="Wagon">Wagon</option>
                                                <option value="Cart">Cart</option>
                                                <option value="Unidentified">Unidentified</option>
                                                <option value="Modern Jeepney">Modern Jeepney</option>
                                                <option value="Others">Others</option>
                                            </select>
                                        <label for="" style="font-size: small;" class="text-muted">Vehicle Body Type <span class="asterisk">*</span></label>
                                    </div>
                                </div>
                            </div>

                            <div class="form-floating">
                                <input type="text" name="vic_reg_owner" id="vic_reg_owner" class="form-control form-control-smd">
                                <label for="" style="font-size: small;" class="text-muted">Registered Owner</label>
                            </div>

                            <div class="form-check mb-3 ms-1 mt-1">
                                <input class="form-check-input" type="checkbox" value="" id="same_as_vic_name">
                                <label class="form-check-label text-muted" for="same_as_vic_name" for="" style="font-size: small;">
                                  Same as victim's name
                                </label>
                            </div>

                            <div class="row g-2 mb-3">
                                <div class="col-md">
                                    <div class="form-floating">
                                        <input type="date" name="vic_drl_exp" id="vic_drl_exp" class="form-control form-control-sm">
                                        <label for="" style="font-size: small;" class="text-muted">Expiration Date</label>
                                    </div>
                                </div>
                                <div class="col-md">
                                    <div class="form-floating">
                                        <input type="text" name="vic_plate_no" id="vic_plate_no" class="form-control form-control-sm" required>
                                        <label for="" style="font-size: small;" class="text-muted">Plate Number <span class="asterisk">*</span></label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-floating mb-3">
                                <select name="vic_severity" id="vic_severity" class="form-select form-select-sm" required>
                                    <option value=""></option>
                                    <option value="Unharmed">Unharmed</option>
                                    <option value="Harmed">Harmed</option>
                                    <option value="Injured">Injured</option>
                                    <option value="Self Accident">Self Accident</option>
                                    <option value="Deceased">Deceased</option>
                                    <option value="Identified">Identified</option>
                                    <option value="Not Interested to Report">Not Interested to Report</option>
                                    <option value="Arrested">Arrested</option>
                                    <option value="Escaped">Escaped</option>
                                    <option value="Unidentified">Unidentified</option>
                                    </select>
                                <label for="" style="font-size: small;" class="text-muted">Severity Status <span class="asterisk">*</span></label>
                            </div>
                        </div>
                    </div>
               
                </div> <!--right side cards -->

        </div> <!-- row -->

        <!--bottom-->
        <div class="row mt-3">
            <div class="col-sm-4">
               <!-- Open Map -->
               <div class="card mb-3" style="height: 350px;">
                <div class="mapouter" style="height: 100%;">
                    <div id="map" style="width:100%;height:100%;"></div>
                </div>
             </div>
            <!-- Close Map-->
            </div>

            <div class="col-sm-8">
                <div class="card mb-3" style="height:auto; min-height: 280px;">
                    <div class="card-header">
                        <label class="label-blue">  <i class="bi bi-text-left"></i> &nbsp;Narrative <span class="asterisk">*</span></label>
                        <i class="bi bi-question-circle" style="color: #d3d3d3; float: right;"></i>
                    </div>
                    <div class="card-body">
                        <textarea class="form-control" name="narrative" placeholder="" style="resize: vertical; height: 200px; width: 100%;" required></textarea>
                    </div>
                </div>

                <center>
                <div class="card mb-3 mt-4" style="width: 60%;">
                    <button type="submit" class="btn btn-primary p-2"id="btn-create" onclick="return confirm('Are you sure you want to add this report?');">
                        Add Incident Report 
                    </button>
                </div>
            </center>
            </div>
        </div> <!--botton row closing-->

    </form>
</div>


  <!-- Script -->
    <script>
        var today = new Date();
        var time = today.getHours() + ":" + today.getMinutes();
        document.getElementById("currentTime").value = time;
    </script>

    <!-- Prevent submitting again when reloaded -->
    <script>
      if ( window.history.replaceState ) {
        window.history.replaceState( null, null, window.location.href );
      }
    </script>

    <!--For Forms-->
    <script type="text/javascript">
        $(document).ready(function(){
    
          $('.nav_btn').click(function(){
            $('.mobile_nav_items').toggleClass('active');
          });
    
          $('#same_as_sus_name').click(function(){
            sus_fname = document.getElementById('sus_fname').value;
            sus_lname = document.getElementById('sus_lname').value; 
            document.getElementById('sus_reg_owner').value=sus_fname + " " +sus_lname; 

          });

          $('#same_as_vic_name').click(function(){
            vic_fname = document.getElementById('vic_fname').value;
            vic_lname = document.getElementById('vic_lname').value; 
            document.getElementById('vic_reg_owner').value=vic_fname + " " +vic_lname; 

          });

            vic_fname = document.getElementById('vic_fname');
            vic_lname = document.getElementById('vic_lname');
            v_sex = document.getElementById('v_sex');
            vic_age = document.getElementById('vic_age');
            vic_add = document.getElementById('vic_add');
            vic_civil_status = document.getElementById('vic_civil_status');
            vic_type = document.getElementById('vic_type');
            vic_drl = document.getElementById('vic_drl');
            vic_vehicle = document.getElementById('vic_vehicle');
            vic_vehicle_body_type = document.getElementById('vic_vehicle_body_type');
            vic_reg_owner = document.getElementById('vic_reg_owner');
            same_as_vic_name = document.getElementById('same_as_vic_name');
            vic_drl_exp = document.getElementById('vic_drl_exp');
            vic_plate_no = document.getElementById('vic_plate_no');
            vic_severity = document.getElementById('vic_severity');

          $('.chk_offense_input').change(function(){
            var selected_offense = new Array();
            var selchk = document.getElementsByClassName("chk_offense_input")

            for (var i=0; i<selchk.length; i++) {
              if(selchk[i].checked){
                selected_offense.push(selchk[i].value);               
              }
            }

            if(selected_offense.length>0){
                document.getElementById('display_offense').value=selected_offense; 
            }

            else {
                document.getElementById('display_offense').value=null;
            }

            if(selected_offense.includes("Self Accident") == true) {
                vic_fname.disabled = true;
                vic_lname.disabled = true;
                v_sex.disabled = true;
                vic_age.disabled = true;
                vic_add.disabled = true;
                vic_civil_status.disabled = true;
                vic_type.disabled = true;
                vic_type.disabled = true;
                vic_drl.disabled = true;
                vic_vehicle.disabled = true;
                vic_vehicle_body_type.disabled = true;
                vic_reg_owner.disabled = true;
                same_as_vic_name.disabled = true;
                vic_drl_exp.disabled = true;
                vic_drl_exp.disabled = true;
                vic_plate_no.disabled = true;
                vic_severity.disabled = true;
            }
            
            if(selected_offense.includes("Self Accident") == false) {
                vic_fname.disabled = false;
                vic_lname.disabled = false;
                v_sex.disabled = false;
                vic_age.disabled = false;
                vic_add.disabled = false;
                vic_civil_status.disabled = false;
                vic_type.disabled = false;
                vic_type.disabled = false;
                vic_drl.disabled = false;
                vic_vehicle.disabled = false;
                vic_vehicle_body_type.disabled = false;
                vic_reg_owner.disabled = false;
                same_as_vic_name.disabled = false;
                vic_drl_exp.disabled = false;
                vic_drl_exp.disabled = false;
                vic_plate_no.disabled = false;
                vic_severity.disabled = false;
            }

          });

          $('#collision_type').change(function(){
              if(this.value == "Self Accident") {
                document.getElementById('btncheck3').checked = true;

                var selected_offense = new Array();
                var selchk = document.getElementsByClassName("chk_offense_input")

                for (var i=0; i<selchk.length; i++) {
                    if(selchk[i].checked){
                        selected_offense.push(selchk[i].value);               
                    }
                }
                document.getElementById('display_offense').value=selected_offense; 


                vic_fname.disabled = true;
                vic_lname.disabled = true;
                v_sex.disabled = true;
                vic_age.disabled = true;
                vic_add.disabled = true;
                vic_civil_status.disabled = true;
                vic_type.disabled = true;
                vic_type.disabled = true;
                vic_drl.disabled = true;
                vic_vehicle.disabled = true;
                vic_vehicle_body_type.disabled = true;
                vic_reg_owner.disabled = true;
                same_as_vic_name.disabled = true;
                vic_drl_exp.disabled = true;
                vic_drl_exp.disabled = true;
                vic_plate_no.disabled = true;
                vic_severity.disabled = true;
              }

              else{
                document.getElementById('btncheck3').checked = false;
               
                var selected_offense = new Array();
                var selchk = document.getElementsByClassName("chk_offense_input")

                for (var i=0; i<selchk.length; i++) {
                    if(selchk[i].checked){
                        selected_offense.push(selchk[i].value);               
                    }
                }

                document.getElementById('display_offense').value=selected_offense; 

                vic_fname.disabled = false;
                vic_lname.disabled = false;
                v_sex.disabled = false;
                vic_age.disabled = false;
                vic_add.disabled = false;
                vic_civil_status.disabled = false;
                vic_type.disabled = false;
                vic_type.disabled = false;
                vic_drl.disabled = false;
                vic_vehicle.disabled = false;
                vic_vehicle_body_type.disabled = false;
                vic_reg_owner.disabled = false;
                same_as_vic_name.disabled = false;
                vic_drl_exp.disabled = false;
                vic_drl_exp.disabled = false;
                vic_plate_no.disabled = false;
                vic_severity.disabled = false;
            }
            
          });

          sus_plate_no = document.getElementById('sus_plate_no');
          vic_plate_no = document.getElementById('vic_plate_no');
          $('#sus_vehicle_body_type').change(function(){
            if(this.value == "Bicycle" | this.value =="Electric Bike" | this.value =="Pedicab" | this.value =="Cart" | this.value =="Unidentified" | this.value =="Others") {
                sus_plate_no.disabled = true;
            }
            else {
                sus_plate_no.disabled = false;
            }
          });

          $('#vic_vehicle_body_type').change(function(){
            if(this.value == "Bicycle" | this.value =="Electric Bike" | this.value =="Pedicab" | this.value =="Cart" | this.value =="Unidentified" | this.value =="Others") {
                vic_plate_no.disabled = true;
            }
            else {
                vic_plate_no.disabled = false;
            }
          });

          Date.prototype.getWeek = function (dowOffset) {
            /*getWeek() was developed by Nick Baicoianu at MeanFreePath: http://www.meanfreepath.com */

                dowOffset = typeof(dowOffset) == 'number' ? dowOffset : 0; //default dowOffset to zero
                var newYear = new Date(this.getFullYear(),0,1);
                var day = newYear.getDay() - dowOffset; //the day of week the year begins on
                day = (day >= 0 ? day : day + 7);
                var daynum = Math.floor((this.getTime() - newYear.getTime() - 
                (this.getTimezoneOffset()-newYear.getTimezoneOffset())*60000)/86400000) + 1;
                var weeknum;
                //if the year starts before the middle of a week
                if(day < 4) {
                    weeknum = Math.floor((daynum+day-1)/7) + 1;
                    if(weeknum > 52) {
                        nYear = new Date(this.getFullYear() + 1,0,1);
                        nday = nYear.getDay() - dowOffset;
                        nday = nday >= 0 ? nday : nday + 7;
                        /*if the next year starts before the middle of
                        the week, it is week #1 of that year*/
                        weeknum = nday < 4 ? 1 : 53;
                    }
                }
                else {
                    weeknum = Math.floor((daynum+day-1)/7);
                }
                return weeknum;
            };
    
          $('#DateCommitted').change(function(){
            
            dt_committed =  document.getElementById('DateCommitted').value;
            dt = new Date(dt_committed);
            day = dt.getDay();

            // year = new Date(dt.getFullYear(),0,1);
            // numberOfDays = Math.floor((dt - year) / (24 * 60 * 60 * 1000));
            // week = Math.ceil(( dt.getDay() + 1 + numberOfDays) / 7);
            
            week = dt.getWeek()
            document.getElementById('week').value = week;
    
            if(day==0){
              document.getElementById('day_of_the_week').value = "Sunday";
            }
    
            if(day==1){
              document.getElementById('day_of_the_week').value = "Monday";
            }
    
            if(day==2){
              document.getElementById('day_of_the_week').value = "Tuesday";
            }
    
            if(day==3){
              document.getElementById('day_of_the_week').value = "Wednesday";
            }
    
            if(day==4){
              document.getElementById('day_of_the_week').value = "Thursday";
            }
    
            if(day==5){
              document.getElementById('day_of_the_week').value = "Friday";
            }
            
            if(day==6){
              document.getElementById('day_of_the_week').value = "Saturday";
            }
          
          });

          
    
    
        });
    
      </script>
      
    


<!-- Google map -->


<!-- Display geolocation data -->

</div>
<script src="https://maps.googleapis.com/maps/api/js?libraries=places&key=AIzaSyACS7G3CoYRTEAOy4vAUdPq1H08ueUoDXI&callback=initMap"></script>

    
{% endblock %}
  {% block jquery %} 
  
  {% endblock %}